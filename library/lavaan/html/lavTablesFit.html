<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Pairwise maximum likelihood fit statistics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lavTablesFitCp {lavaan}"><tr><td>lavTablesFitCp {lavaan}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Pairwise maximum likelihood fit statistics</h2>

<h3>Description</h3>

<p>Three measures of fit for the pairwise maximum likelihood estimation method that are based on likelihood ratios (LR) are defined: 
<i>C_F</i>, <i>C_M</i>, and <i>C_P</i>. Subscript <i>F</i> signifies a comparison of model-implied proportions of full response 
patterns with observed sample proportions, subscript <i>M</i> signifies a comparison of model-implied proportions of full response 
patterns with the proportions implied by the assumption of multivariate normality, and subscript <i>P</i> signifies
a comparison of model-implied proportions of pairs of item responses with the observed proportions of pairs of item responses. 
</p>


<h3>Usage</h3>

<pre>
lavTablesFitCf(object)
lavTablesFitCp(object, alpha = 0.05)
lavTablesFitCm(object)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>An object of class <code><a href="lavaan-class.html">lavaan</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
<p>The nominal level of signifiance of global fit.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4><i>C_F</i></h4>

<p>The <i>C_F</i> statistic compares the log-likelihood of the model-implied proportions (<i>&pi;_r</i>) with the observed proportions (<i>p_r</i>)
of the full multivariate responses patterns:
</p>
<p style="text-align: center;"><i>
C_F = 2N&sum;_{r}p_{r}\ln[p_{r}/\hat{&pi;}_{r}],
</i></p>

<p>which asymptotically has a chi-square distribution with
</p>
<p style="text-align: center;"><i>
df_F = m^k - n - 1,
</i></p>

<p>where <i>k</i> denotes the number of items with discrete response scales, <i>m</i> denotes the number of response options, and <i>n</i> denotes 
the number of parameters to be estimated. Notice that <i>C_F</i> results may be biased because of large numbers of empty cells in the multivariate 
contingency table.
</p>



<h4><i>C_M</i></h4>

<p>The <i>C_M</i> statistic is based on the <i>C_F</i> statistic, and compares the proportions implied by the model of interest (Model 1) 
with proportions implied by the assumption of an underlying multivariate normal distribution (Model 0):
</p>
<p style="text-align: center;"><i>
C_M = C_{F1} - C_{F0},
</i></p>

<p>where <i>C_{F0}</i> is <i>C_F</i> for Model 0 and <i>C_{F1}</i> is <i>C_F</i> for Model 1. Statistic <i>C_M</i> has a chi-square distribution with 
degrees of freedom
</p>
<p style="text-align: center;"><i>
df_M = k(k-1)/2 + k(m-1) - n_{1},
</i></p>

<p>where <i>k</i> denotes the number of items with discrete response scales, <i>m</i> denotes the number of response options, and <i>k(k-1)/2</i> 
denotes the number of polychoric correlations, <i>k(m-1)</i> denotes the number of thresholds, and <i>n_1</i> is the number of parameters of the 
model of interest. Notice that <i>C_M</i>  results may be biased because of large numbers of empty cells in the multivariate contingency table. However, 
bias may cancels out as both Model 1 and Model 0 contain the same pattern of empty responses.
</p>



<h4><i>C_P</i></h4>

<p>With the <i>C_P</i> statistic we only consider pairs of responses, and compare observed sample proportions (<i>p</i>) with model-implied proportions 
of pairs of responses(<i>&pi;</i>). For items <i>i</i> and <i>j</i> we obtain a pairwise likelihood ratio test statistic <i>C_{P_{ij}}</i>
</p>
<p style="text-align: center;"><i>
C_{P_{ij}}=2N&sum;_{c_i=1}^m &sum;_{c_j=1}^m
p_{c_i,c_j}\ln[p_{c_i,c_j}/\hat{&pi;}_{c_i,c_j}],
</i></p>

<p>where <i>m</i> denotes the number of response options and <i>N</i> denotes sample size. The <i>C_P</i> statistic has an asymptotic chi-square distribution 
with degrees of freedom equal to the information <i>(m^2 -1)</i> minus the number of parameters (2(m-1) thresholds and 1 correlation),
</p>
<p style="text-align: center;"><i>
df_P = m^{2} - 2(m - 1) - 2.
</i></p>

<p>As <i>k</i> denotes the number of items, there are <i>k(k-1)/2</i> possible pairs of items. The <i>C_P</i> statistic should therefore be applied with 
a Bonferroni adjusted level of significance <i>&alpha;^*</i>, with
</p>
<p style="text-align: center;"><i>
&alpha;^*= &alpha; /(k(k-1)/2)),
</i></p>

<p>to keep the family-wise error rate at <i>&alpha;</i>. The hypothesis of overall goodness-of-fit is tested at <i>&alpha;</i> and rejected as 
soon as <i>C_P</i> is significant at <i>&alpha;^*</i> for at least one pair of items. Notice that with dichotomous items, <i>m = 2</i>, 
and <i>df_P = 0</i>, so that hypothesis can not be tested. 
</p>



<h3>References</h3>

<p>Barendse, M. T., Ligtvoet, R., Timmerman, M. E., &amp; Oort, F. J. (2016). Structural Equation Modeling of Discrete data: 
Model Fit after Pairwise Maximum Likelihood. <em>Frontiers in psychology, 7</em>, 1-8. 
</p>
<p>Joreskog, K. G., &amp; Moustaki, I. (2001). Factor analysis of ordinal variables: A comparison of three approaches. 
<em>Multivariate Behavioral Research, 36</em>, 347-387. 
</p>


<h3>See Also</h3>

<p><code><a href="lavTables.html">lavTables</a>, <a href="lavaan.html">lavaan</a></code>
</p>


<h3>Examples</h3>

<pre>
# Data
HS9 &lt;- HolzingerSwineford1939[,c("x1","x2","x3","x4","x5",
                                 "x6","x7","x8","x9")]
HSbinary &lt;- as.data.frame( lapply(HS9, cut, 2, labels=FALSE) )

# Single group example with one latent factor
HS.model &lt;- ' trait =~ x1 + x2 + x3 + x4 '
fit &lt;- cfa(HS.model, data=HSbinary[,1:4], ordered=names(HSbinary[,1:4]),
           estimator="PML")
lavTablesFitCm(fit)
lavTablesFitCp(fit)
lavTablesFitCf(fit)
</pre>

<hr /><div style="text-align: center;">[Package <em>lavaan</em> version 0.6-8 <a href="00Index.html">Index</a>]</div>
</body></html>
